import numpy as np
from scipy.interpolate import BSpline,make_interp_spline
from casadi import *

# coefficients = [-0., 0., 1.73178748, -4.62428812, -3.89599197, -4.00449317,
#             -4.08603518, -3.65136577, -5.30850164, 3.44137986, -1.19981941,
#             -0.41570498, 2.49342195, -4.87298674, -3.68483492, -4.82181469,
#             2.63919759, -0.62009112, -0.24410477, 1.58271254, -4.53378611,
#             -3.91008981, -4.03809669, -3.93752345, -4.21180944, -3.21523805,
#             -6.9272381, 6.92419045, 3.2304763, 4.15390436, 4.15390625,
#             3.23047127, 6.92421156, -6.92731651, -3.21494551, -4.21290147,
#             -3.93344863, -4.05330397, -3.8533355, -4.81397622, 3.40183475,
#             -5.02975801, -3.5112621, -5.36877524, 4.26455895, -3.29640526,
#             4.82049492, 3.84811555, 4.01686457, 4.08442616, 3.64543078,
#             5.33385071, -4.23816192, 3.28922811, -4.81980582, -3.84804072,
#             -4.01770781, -4.08112805, -3.65777999, -5.28775155, 3.95358404,
#             -1.14781398, -0.65755748, 3.05952569, -5.0273071, -3.66169335,
#             -4.75637634, 2.20793799, -0.45952605, -0.28523047, 1.59405177,
#             -4.53486452, -3.90991511, -4.0381435, -3.9375109, -4.2118128,
#             -3.21523715, -6.92723834, 6.92419052, 3.23047628, 4.15390437,
#             4.15390625, 3.23047127, 6.92421156, -6.92731651, -3.21494551,
#             -4.21290147, -3.93344863, -4.05330397, -3.8533355, -4.81397622,
#             3.40183475, -5.02975801, -3.5112621, -5.36877524, 4.26455895,
#             -3.29640526, 4.82049492, 3.84811555, 4.01686457, 4.08442616,
#             3.64543078, 5.33385071, -4.23816192, 3.28922813, -4.81980585,
#             -3.84804066, -4.01770805, -4.08112713, -3.65778345, -5.28773865,
#             3.9535044, -1.14697659, -0.66059457, 3.06851244, -5.04185227,
#             -3.62075736, -4.98543301, -0., 0.]
# knots = [-3.1307295, -3.1307295, -3.1307295, -3.1307295, -2.8561956, -2.5816618,
        # -2.4589926, -2.3363234, -2.2136543, -2.0909851, -1.9683159, -1.8456467,
        # -1.5711129, -1.2586129, -0.9461129, -0.7475113, -0.6248422, -0.502173,
        # -0.2857143, 0.0625, 0.375, 0.6875, 1.0, 1.1226692, 1.2453384, 1.3680076,
        # 1.4906767, 1.6133459, 1.7360151, 1.8586843, 1.9813535, 2.1040227,
        # 2.2266919, 2.349361, 2.4720302, 2.5946994, 2.7173686, 2.8400378,
        # 2.962707, 3.0853762, 3.2080453, 3.3307145, 3.6052484, 3.8797822,
        # 4.0024514, 4.1251206, 4.2477898, 4.5602898, 4.7968574, 4.9195266,
        # 5.0421958, 5.164865, 5.2875342, 5.4102034, 5.5328726, 5.8453726,
        # 6.0819402, 6.2046094, 6.3272786, 6.4499478, 6.572617, 6.6952862,
        # 6.8179553, 7.1304553, 7.4429553, 7.7554553, 7.9160907, 8.0387599,
        # 8.1614291, 8.4247824, 8.7729967, 9.0854967, 9.3979967, 9.7104967,
        # 9.8331659, 9.9558351, 10.0785043, 10.2011734, 10.3238426, 10.4465118,
        # 10.569181, 10.6918502, 10.8145194, 10.9371886, 11.0598577, 11.1825269,
        # 11.3051961, 11.4278653, 11.5505345, 11.6732037, 11.7958729, 11.918542,
        # 12.0412112, 12.3157451, 12.5902789, 12.7129481, 12.8356173, 12.9582865,
        # 13.2707865, 13.5073541, 13.6300233, 13.7526925, 13.8753617, 13.9980309,
        # 14.1207001, 14.2433693, 14.5558693, 14.7924369, 14.9151061, 15.0377753,
        # 15.1604445, 15.2831137, 15.4057829, 15.528452, 15.840952, 16.153452,
        # 16.465952, 16.6265874, 16.7492566, 16.8719258, 17.1352791, 17.1352791,
        # 17.1352791, 17.1352791]

a = np.random.randint(1, 10)
b = np.random.randint(1, 10)
print(a)
print(b)
x = np.linspace(0, a, b)
print("x:", x)
y = np.sin(x)
spl = make_interp_spline(x, y, k=3)  # type: BSpline
coefficients = spl.c
knots = spl.t
print("knots:", knots)
degree = 3

total_segments = len(knots) - degree - 1
print("total_segments:", total_segments)

# num_seg = 50
# s_test = 48.9

# # no. of segments = len(knots) - degree - 1
# # len(knots) = len(coefficients) + degree + 1

# knot_len = num_seg + degree + 1
# coeff_len = knot_len - degree - 1
# print("knot_len:", knot_len)
# print("coeff_len:", coeff_len)

# kapparef_s = Function.bspline('kapparef_s', [knots[0:knot_len]], coefficients[0:coeff_len], [degree], 1)
# print("cropped spline: ",kapparef_s(s_test))

# kapparef_s_full = Function.bspline('kapparef_s', [knots], coefficients, [degree], 1)
# print("full spline: ", kapparef_s_full(s_test))

# print("derivative: ",kapparef_s_full.derivative()(s_test))